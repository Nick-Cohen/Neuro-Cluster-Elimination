Test loss functions

Add multiple elimination functionality

Compute approximate message gradients in advance